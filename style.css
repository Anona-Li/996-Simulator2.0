:root {
  --bg:#f4f5f7;
  --ink:#222;
  --muted:#7a7f87;
  --primary:#3a86ff;
  --danger:#e45656;
  --ok:#22aa66;
}
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, "PingFang SC", "Microsoft YaHei", sans-serif;
  background: var(--bg);
  color: var(--ink);
}

#viewport { position: fixed; inset: 0; background:#000; overflow:hidden; display:flex; align-items:center; justify-content:center; }
#viewport::before { content: ""; position: absolute; inset: 0; background: var(--bg-image, url('img/background/background-start.png')) center/contain no-repeat; z-index: 0; pointer-events: none; }
#app { position: relative; z-index: 1; width: 1080px; height: 1920px; transform: scale(var(--scale,1)); transform-origin: center center; background: transparent; overflow: visible; display:flex; flex-direction:column; }
.prestart .topbar, .prestart .desk, .prestart .keyboard { display: none; }
/* 资源加载界面 */
.loading-overlay { 
  position: fixed; 
  inset: 0; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
  z-index: 10000; 
}

.loading-container {
  text-align: center;
  color: white;
  max-width: 400px;
  padding: 2rem;
}

.loading-title {
  font-size: 2rem;
  font-weight: bold;
  margin-bottom: 2rem;
  text-shadow: 0 2px 4px rgba(0,0,0,0.3);
}

.loading-progress {
  width: 100%;
  height: 8px;
  background: rgba(255,255,255,0.2);
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 1rem;
  box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
}

.loading-bar {
  width: 0%;
  height: 100%;
  background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
  border-radius: 4px;
  transition: width 0.3s ease;
  position: relative;
}

.loading-bar::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.4) 50%, transparent 100%);
  animation: loading-shine 2s infinite;
}

@keyframes loading-shine {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

.loading-text {
  font-size: 1.2rem;
  font-weight: 600;
  opacity: 0.9;
}

.start-overlay { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; backdrop-filter: blur(0px); background: transparent; z-index: 5000; }
.start-btn { 
  display: inline-block;
  padding: 10px 20px;
  font-size: 24px;
  font-weight: bold;
  text-align: center;
  text-decoration: none;
  color: #fff;
  background-color: #ff5252;
  border: 2px solid #000;
  border-radius: 10px;
  box-shadow: 5px 5px 0px #000;
  transition: all 0.3s ease;
  cursor: pointer;
  transform: scale(4);
  transform-origin: center center;
}

.start-btn:hover {
  background-color: #fff;
  color: #ff5252;
  border: 2px solid #ff5252;
  box-shadow: 5px 5px 0px #ff5252;
}

.start-btn:active {
  background-color: #fcf414;
  box-shadow: none;
  transform: scale(4) translateY(4px);
}
#viewport.started::before { filter: none; }
#viewport.started::after { content: ""; position: absolute; inset: 0; background: transparent; z-index: 0; pointer-events: none; }
@media (max-width: 99999px) {
  /* 自动缩放以适配窗口，保持虚拟分辨率 */
  #app { transform: scale(var(--scale,1)); }
}

.topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  gap: 8px;
}
.clock { padding: 6px 10px; background: #fff; border-radius: 8px; box-shadow: 0 1px 2px rgba(0,0,0,.06); transform: scale(2); transform-origin: left top; }
.numeric-stats { margin-left:auto; display:flex; align-items:center; gap: 10px; transform: scale(2); transform-origin: right top; }
.nstat { padding:4px 10px; background:#fff; border-radius:8px; box-shadow:0 1px 2px rgba(0,0,0,.06); font-weight:600; }
.nstat span { min-width: 44px; display:inline-block; text-align:right; }
.nstat.money { color:#0a7; }

.desk { width: 100%; max-width: 980px; margin: 0 auto; padding: 10px 12px 20px; position: relative; flex:1; display:flex; flex-direction:column; }
.monitor { background: transparent; border-radius: 0; border:none; padding: 0; position: relative; display:flex; align-items:center; justify-content:center; flex:1; z-index: 0; box-shadow: none; }
.screen { position: relative; background: transparent; background-color: transparent; border-radius: 12px; width: 70%; max-width: 880px; aspect-ratio: 16 / 9; height: auto; box-shadow: none; overflow: visible; margin: 0 auto; transform: translateY(18%) scale(2.1); transform-origin: center top; z-index: 1500; }
.work-panel { position:absolute; inset: 8% 8% 8% 8%; background:#fff8e1; border: none; border-radius: 10px; padding: 15px; display:flex; flex-direction:column; gap:12px; align-items:stretch; justify-content:center; z-index: 2; transform: translateY(-41%) scale(0.64); transform-origin: center center; font-size: 18px; box-shadow: inset 0 2px 4px rgba(0,0,0,0.1); }
.work-panel h3 { margin:0; text-align:center; font-size: 1.4em; }
.progress { width:100%; height: 14px; background:#f0dca4; border-radius: 10px; overflow:hidden; }
.progress-fill { width:0%; height:100%; background: linear-gradient(90deg,var(--primary),#7cd4ff); }
.progress-pct { text-align: right; font-weight: 600; color: #7a672f; margin-top: 6px; font-size: 1.1em; }
.note { color: var(--muted); text-align:center; font-size: 1.1em; }

.fish-toggle { position:absolute; left: 8px; bottom: 8px; width: 63px; height: 63px; border-radius: 15px; border:none; background:#e6f7ff; box-shadow:0 1px 2px rgba(0,0,0,.06); font-size:33px; z-index: 3001; pointer-events: auto; }
.fish-toggle.fish-shake { animation: fish-shake 100ms linear 8; }
@keyframes fish-shake {
  0% { transform: translate(0,0) scale(1); }
  25% { transform: translate(3px,-3px) scale(1.1); }
  50% { transform: translate(-3px,3px) scale(1.15); }
  75% { transform: translate(3px,3px) scale(1.1); }
  100% { transform: translate(0,0) scale(1); }
}
.fish-panel { position:absolute; inset: 0; background:#fff6dc; border-radius: 12px; box-shadow:0 14px 30px rgba(0,0,0,.18); display:flex; flex-direction:column; z-index: 5; font-size: 20px; }
.fish-header { display:flex; align-items:center; justify-content:space-between; padding:8px 12px; font-size: 30px; }
.fish-close { border:none; background:transparent; font-size:33px; padding:6px; }
.fish-body { flex:1; padding: 12px 14px; color:#7a672f; font-size: 30px; line-height: 1.5; }
.hidden { display:none; }

.keyboard { margin-top: 0; position: absolute; left: 50%; bottom: 12%; transform: translateX(-50%); width: 86%; height: 156px; border-radius: 12px; background: transparent; background-color: transparent; font-size:0; box-shadow: none; z-index: 1000; pointer-events: auto; cursor: pointer; display: block; line-height: 0; border: none; outline: none; }
.keyboard:active { transform: translateX(-50%) translateY(1px); }
.keyboard:focus { outline: none; border: none; }
.keyboard:hover { outline: none; border: none; }

.boss { position:absolute; left: 0; right: 0; bottom: 0; width: 100%; height: 100%; background: url('img/ui/ui-boss.png.png') left bottom/contain no-repeat; background-position: -40px bottom; border-radius: 0; box-shadow:none; z-index: 10000; display:none; pointer-events: none; }
.boss.shake { animation: boss-shake 120ms linear 8; }
@keyframes boss-shake {
  0% { transform: translate(0,0); }
  25% { transform: translate(2px,-2px); }
  50% { transform: translate(-2px,2px); }
  75% { transform: translate(2px,2px); }
  100% { transform: translate(0,0); }
}

/* 摸鱼关闭按钮的boss抖动动画 - 第一天 */
.fish-close.boss-shake { animation: fish-boss-shake-day1 80ms linear infinite; }
@keyframes fish-boss-shake-day1 {
  0% { transform: translate(0,0); }
  25% { transform: translate(3px,-3px); }
  50% { transform: translate(-3px,3px); }
  75% { transform: translate(3px,3px); }
  100% { transform: translate(0,0); }
}

/* 摸鱼关闭按钮的boss抖动动画 - 第二天及以后 */
.fish-close.boss-shake.day2-plus { animation: fish-boss-shake-day2-plus 60ms linear infinite; }
@keyframes fish-boss-shake-day2-plus {
  0% { transform: translate(0,0); }
  12.5% { transform: translate(8px,-6px); }
  25% { transform: translate(-6px,8px); }
  37.5% { transform: translate(6px,6px); }
  50% { transform: translate(-8px,-4px); }
  62.5% { transform: translate(4px,-8px); }
  75% { transform: translate(-4px,4px); }
  87.5% { transform: translate(8px,2px); }
  100% { transform: translate(0,0); }
}

.modal { position: fixed; inset: 0; display:flex; align-items:center; justify-content:center; background: rgba(0,0,0,.35); z-index: 20000; }
.modal .modal-content { 
  background-color: #f2f3f7;
  border-radius: 0.75em;
  width: min(92vw, 520px);
  box-shadow: 1em 1em 1em #d8dae0b1, -0.75em -0.75em 1em #ffffff;
  border: 1.5px solid #f2f3f7;
  transition: ease 0.2s;
  padding: 0;
  overflow: hidden;
  transform: scale(1.6);
  transform-origin: center;
}

/* 随机事件模态：恢复到200%缩放，字体与按钮更大 */
#eventModal .modal-content { transform: scale(2); }
#eventModal .modal-title { font-size: 1.4em; }
#eventModal .modal-desc { font-size: 1.1em; }
#eventModal .btn { font-size: 22px; padding: 12px 20px; }
/* 随机事件模态：外发光调淡 */
#eventModal { background: rgba(0,0,0,.25); }
#eventModal .modal-content { box-shadow: 0.6em 0.6em 0.6em rgba(0,0,0,0.12), -0.45em -0.45em 0.6em rgba(255,255,255,0.7); }

/* 结算模态：不限制高度，必要时允许滚动，且内容不裁剪 */
#summaryModal { overflow: auto; }
#summaryModal .modal-content { max-height: none; overflow: visible; }
.modal .modal-content:hover {
  background-color: #d3ddf1;
  border: 1.5px solid #1677ff;
}
/* 事件内容不再单独缩放，跟随 #app */
.modal .modal-container {
  margin-top: 1.25em;
  margin-bottom: 1.375em;
  margin-left: 1.375em;
  margin-right: 2em;
  display: flex;
  flex-direction: row;
  gap: 0.75em;
}
.modal .status-ind {
  width: 0.625em;
  height: 0.625em;
  background-color: #ff0000;
  margin: 0.375em 0;
  border-radius: 0.5em;
}
.modal .text-wrap {
  display: flex;
  flex-direction: column;
  gap: 0.25em;
  color: #333;
  flex: 1;
}
.modal .modal-title { 
  font-weight: 500; 
  margin: 0;
  color: #333;
  font-size: 1em;
}
.modal .modal-desc { 
  color: #777; 
  margin: 0;
  font-size: 0.875em;
}
.modal .modal-actions { 
  display: flex; 
  flex-direction: row; 
  gap: 1em; 
  align-items: center; 
  margin-top: 0.875em;
}
.btn { 
  font-size: 15px;
  background-color: transparent;
  border: none;
  cursor: pointer;
  transition: ease 0.2s;
}
.btn.primary-cta {
  font-weight: 600;
  color: #1677ff;
  border-radius: 1.5em;
  padding: 8px 16px;
}
.btn.secondary-cta {
  font-weight: 400;
  color: #666;
  padding: 8px 16px;
}
.btn:hover {
  text-decoration: underline;
}
.modal.hidden { display: none; }

.toast { 
  position: fixed; 
  bottom: 16px; 
  left: 50%; 
  transform: translateX(-50%); 
  z-index: 50; 
  transform: scale(2);
  transform-origin: center bottom;
}
.toast.center { 
  top: 50%; 
  bottom: auto; 
  transform: translate(-50%, -50%) scale(2); 
  transform-origin: center center;
}

/* 新的toast样式 */
.toast .flex {
  display: flex;
}

.toast .flex-col {
  flex-direction: column;
}

.toast .gap-2 {
  gap: 0.75rem;
}

.toast .w-60 {
  width: 15rem;
}

.toast .sm\\:w-72 {
  width: 18rem;
}

.toast .text-\[10px\] {
  font-size: 14px;
}

.toast .sm\\:text-xs {
  font-size: 16px;
}

.toast .z-50 {
  z-index: 50;
}

.toast .error-alert {
  background-color: #232531;
  border-radius: 0.5rem;
  padding: 12px;
  min-height: 3.5rem;
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  width: 100%;
  cursor: default;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
}

.toast .sm\\:h-14 {
  height: 3.5rem;
}

.toast .rounded-lg {
  border-radius: 0.5rem;
}

.toast .bg-\[\#232531\] {
  background-color: #232531;
}

.toast .px-\[10px\] {
  padding-left: 10px;
  padding-right: 10px;
}

.toast .text-\[\#d65563\] {
  color: #d65563;
}

.toast .bg-white\/5 {
  background-color: rgba(255, 255, 255, 0.05);
}

.toast .backdrop-blur-xl {
  backdrop-filter: blur(24px);
}

.toast .p-1 {
  padding: 0.25rem;
}

/* 图标容器优化 */
.toast .flex.gap-2 {
  align-items: flex-start;
  gap: 0.75rem;
}

.toast .text-\[\#d65563\].bg-white\/5.backdrop-blur-xl.p-1.rounded-lg {
  flex-shrink: 0;
  margin-top: 0.125rem;
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 2rem;
  min-height: 2rem;
  background-color: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(214, 85, 99, 0.3);
}

/* 确保SVG图标显示 */
.toast svg {
  display: block;
  width: 100%;
  height: 100%;
  color: #d65563;
  stroke: #d65563;
}

.toast .text-white {
  color: white;
  font-weight: 600;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.8);
}

.toast .text-gray-500 {
  color: #e5e7eb;
  font-weight: 500;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.6);
}

.toast .text-gray-600 {
  color: #4b5563;
}

/* 关闭按钮优化 */
.toast button {
  flex-shrink: 0;
  margin-top: 0.125rem;
}

.toast .hover\:bg-white\/10:hover {
  background-color: rgba(255, 255, 255, 0.1);
}

.toast .rounded-md {
  border-radius: 0.375rem;
}

.toast .transition-colors {
  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
  transition-duration: 150ms;
}

.toast .ease-linear {
  transition-timing-function: linear;
}

.toast .w-6 {
  width: 1.5rem;
}

.toast .h-6 {
  height: 1.5rem;
}

/* 文字容器优化 */
.toast .toast-text-container {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  line-height: 1.4;
  min-width: 0;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.toast p {
  margin: 0;
  padding: 0;
  line-height: 1.3;
  white-space: normal;
  word-break: break-word;
}

/* 心情低于阈值的提示效果 */
.shake-ui { animation: ui-shake 120ms linear 8; }
@keyframes ui-shake {
  0% { transform: translateX(0); }
  25% { transform: translateX(2px); }
  50% { transform: translateX(-2px); }
  75% { transform: translateX(2px); }
  100% { transform: translateX(0); }
}
.blur-brief { filter: blur(2px); transition: filter .2s linear; }

/* 结算卡片样式（参考提供样式） */
.card { --primary:#ff3e00; --primary-hover:#ff6d43; --secondary:#4d61ff; --secondary-hover:#5e70ff; --accent:#00e0b0; --text:#050505; --bg:#ffffff; --shadow-color:#000000; --pattern-color:#cfcfcf; position: relative; width: 20em; background: var(--bg); border: 0.35em solid var(--text); border-radius: 0.6em; box-shadow: 0.7em 0.7em 0 var(--shadow-color), inset 0 0 0 0.15em rgba(0,0,0,0.05); transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1); overflow: hidden; font-family: ui-sans-serif, system-ui, sans-serif; transform-origin: center; margin: 0 auto; }
.card:hover { transform: translate(-0.4em, -0.4em) scale(1.02); box-shadow: 1em 1em 0 var(--shadow-color); }
.card:hover .card-pattern-grid,.card:hover .card-overlay-dots{ opacity:1; }
.card:active{ transform: translate(0.1em,0.1em) scale(0.98); box-shadow: 0.5em 0.5em 0 var(--shadow-color); }
.card::before{ content:""; position:absolute; top:-1em; right:-1em; width:4em; height:4em; background:var(--accent); transform: rotate(45deg); z-index:1; }
.card::after{ content:"★"; position:absolute; top:0.4em; right:0.4em; color:var(--text); font-size:1.2em; font-weight:bold; z-index:2; }
.card-pattern-grid{ position:absolute; inset:0; background-image: linear-gradient(to right, rgba(0,0,0,0.05) 1px, transparent 1px), linear-gradient(to bottom, rgba(0,0,0,0.05) 1px, transparent 1px); background-size:0.5em 0.5em; pointer-events:none; opacity:0.5; transition: opacity 0.4s ease; z-index:1; }
.card-overlay-dots{ position:absolute; inset:0; background-image: radial-gradient(var(--pattern-color) 1px, transparent 1px); background-size:1em 1em; background-position:-0.5em -0.5em; pointer-events:none; opacity:0; transition: opacity 0.4s ease; z-index:1; }
.bold-pattern{ position:absolute; top:0; right:0; width:6em; height:6em; opacity:0.15; pointer-events:none; z-index:1; }
.card-title-area{ position:relative; padding:1.4em; background:var(--primary); color:var(--bg); font-weight:800; font-size:1.2em; display:flex; justify-content:space-between; align-items:center; border-bottom:0.35em solid var(--text); text-transform:uppercase; letter-spacing:0.05em; z-index:2; overflow:hidden; }
.card-title-area::before{ content:""; position:absolute; top:0; left:0; width:100%; height:100%; background:repeating-linear-gradient(45deg, rgba(0,0,0,0.1), rgba(0,0,0,0.1) 0.5em, transparent 0.5em, transparent 1em); pointer-events:none; opacity:0.3; }
.card-tag{ background:var(--bg); color:var(--text); font-size:0.6em; font-weight:800; padding:0.4em 0.8em; border:0.15em solid var(--text); border-radius:0.3em; box-shadow:0.2em 0.2em 0 var(--shadow-color); text-transform:uppercase; letter-spacing:0.1em; transform: rotate(3deg); transition: all 0.3s ease; }
.card:hover .card-tag{ transform: rotate(-2deg) scale(1.1); box-shadow:0.25em 0.25em 0 var(--shadow-color); }
.card-body{ position:relative; padding:1.5em; z-index:2; }
.card-description{ margin-bottom:1.5em; color:var(--text); font-size:0.95em; line-height:1.4; font-weight:500; }
.card-description .big-line{ font-size:1.3em; font-weight:800; }
.feature-grid{ display:grid; grid-template-columns:1fr 1fr; gap:1em; margin-bottom:1.5em; }
.feature-item{ display:flex; align-items:center; gap:0.6em; transition: transform 0.2s ease; }
.feature-item:hover{ transform: translateX(0.3em); }
.feature-icon{ width:1.4em; height:1.4em; display:flex; align-items:center; justify-content:center; background:var(--secondary); border:0.12em solid var(--text); border-radius:0.3em; box-shadow:0.2em 0.2em 0 rgba(0,0,0,0.2); transition: all 0.2s ease; }
.feature-item:hover .feature-icon{ background:var(--secondary-hover); transform: rotate(-5deg); }
.feature-icon svg{ width:0.9em; height:0.9em; fill:var(--bg); }
.feature-text{ font-size:0.85em; font-weight:600; color:var(--text); }
.card-actions{ display:flex; justify-content:space-between; align-items:center; margin-top:1.5em; padding-top:1.2em; border-top:0.15em dashed rgba(0,0,0,0.15); position:relative; }
.card-actions::before{ content:"✂"; position:absolute; top:-0.8em; left:50%; transform: translateX(-50%) rotate(90deg); background:var(--bg); padding:0 0.5em; font-size:1em; color: rgba(0,0,0,0.4); }
.price{ position:relative; font-size:1.8em; font-weight:800; color:var(--text); background:var(--bg); }
.price::before{ content:""; position:absolute; bottom:0.15em; left:0; width:100%; height:0.2em; background:var(--accent); z-index:-1; opacity:0.5; }
.price-currency{ font-size:0.6em; font-weight:700; vertical-align:top; margin-right:0.1em; }
.price-period{ display:block; font-size:0.4em; font-weight:600; color: rgba(0,0,0,0.6); margin-top:0.2em; }
.card-button{ position:relative; background:var(--secondary); color:var(--bg); font-size:0.9em; font-weight:700; padding:0.7em 1.2em; border:0.2em solid var(--text); border-radius:0.4em; box-shadow:0.3em 0.3em 0 var(--shadow-color); cursor:pointer; transition: all 0.2s ease; overflow:hidden; text-transform:uppercase; letter-spacing:0.05em; }
.card-button::before{ content:""; position:absolute; top:0; left:-100%; width:100%; height:100%; background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.2) 50%, transparent 100%); transition:left 0.6s ease; }
.card-button:hover{ background:var(--secondary-hover); transform: translate(-0.1em, -0.1em); box-shadow:0.4em 0.4em 0 var(--shadow-color); }
.card-button:hover::before{ left:100%; }
.card-button:active{ transform: translate(0.1em, 0.1em); box-shadow:0.15em 0.15em 0 var(--shadow-color); }
.dots-pattern{ position:absolute; bottom:2em; left:-2em; width:8em; height:4em; opacity:0.3; transform: rotate(-10deg); pointer-events:none; z-index:1; }
.accent-shape{ position:absolute; width:2.5em; height:2.5em; background:var(--secondary); border:0.15em solid var(--text); border-radius:0.3em; transform: rotate(45deg); bottom:-1.2em; right:2em; z-index:0; transition: transform 0.3s ease; }
.card:hover .accent-shape{ transform: rotate(55deg) scale(1.1); }
.stamp{ position:absolute; bottom:1.5em; left:1.5em; width:4em; height:4em; display:flex; align-items:center; justify-content:center; border:0.15em solid rgba(0,0,0,0.3); border-radius:50%; transform: rotate(-15deg); opacity:0.2; z-index:1; }
.stamp-text{ font-size:0.6em; font-weight:800; text-transform:uppercase; letter-spacing:0.05em; }
.corner-slice{ position:absolute; bottom:0; left:0; width:1.5em; height:1.5em; background:var(--bg); border-right:0.25em solid var(--text); border-top:0.25em solid var(--text); border-radius:0 0.5em 0 0; z-index:1; }

/* 让模态中卡片居中且不被原样式干扰 */
.modal .modal-content.cardized { 
  background: transparent; 
  border: none; 
  box-shadow: none; 
  width: auto; 
  padding: 0; 
  display: flex; 
  justify-content: center; 
  align-items: center;
}

/* 日夜过场遮罩 */
.daycycle-overlay { position: fixed; inset: 0; z-index: 999999; pointer-events: none; display: none; background: transparent; }
.daycycle-overlay.active { display: block; }
.daycycle-layer { position: absolute; inset: 0; background-position: center; background-size: cover; background-repeat: no-repeat; opacity: 0; transition: opacity 600ms ease; }
.daycycle-layer.show { opacity: 1; }

@media (max-width: 640px) {
  .stat .bar { width: 26vw; max-width: 140px; }
  .screen { height: 52vh; min-height: 300px; }
  .keyboard { height: 56px; font-size: 18px; }
  
  /* 移动端顶部栏适配 */
  .topbar { 
    position: sticky; 
    top: 0; 
    background: var(--bg); 
    z-index: 5;
    padding: 4px 6px;
    gap: 4px;
    flex-wrap: wrap;
  }
  
  /* 移动端时钟样式调整 */
  .clock { 
    transform: scale(1.2); 
    transform-origin: left top;
    padding: 4px 6px;
    font-size: 12px;
    white-space: nowrap;
  }
  
  /* 移动端数值统计样式调整 */
  .numeric-stats { 
    transform: scale(1.2); 
    transform-origin: right top;
    gap: 6px;
    flex-wrap: wrap;
  }
  
  .nstat { 
    padding: 3px 6px; 
    font-size: 11px;
    white-space: nowrap;
  }
  
  .nstat span { 
    min-width: 30px; 
  }
  
  .boss { transform: scale(.9); left: -8px; height: 100%; }
}

/* 更小屏幕的额外适配 */
@media (max-width: 480px) {
  .topbar {
    padding: 2px 4px;
    gap: 2px;
  }
  
  .clock { 
    transform: scale(1); 
    font-size: 10px;
    padding: 3px 5px;
  }
  
  .numeric-stats { 
    transform: scale(1); 
    gap: 4px;
  }
  
  .nstat { 
    padding: 2px 4px; 
    font-size: 9px;
  }
  
  .nstat span { 
    min-width: 25px; 
  }
}

/* 超小屏幕适配 */
@media (max-width: 360px) {
  .topbar {
    flex-direction: column;
    align-items: stretch;
    padding: 2px;
    gap: 2px;
  }
  
  .clock { 
    transform: scale(0.9); 
    align-self: center;
  }
  
  .numeric-stats { 
    transform: scale(0.9); 
    justify-content: center;
    flex-wrap: wrap;
  }
}

/* 移动端弹窗和其他UI元素适配 */
@media (max-width: 640px) {
  /* 事件弹窗缩放调整 */
  #eventModal .modal-content { 
    transform: scale(1.4); 
    max-width: 90vw;
  }
  
  /* Toast提示框适配 */
  .toast { 
    transform: scale(1.4);
    max-width: 85vw;
  }
  
  .toast.center { 
    transform: translate(-50%, -50%) scale(1.4); 
  }
  
  /* 摸鱼按钮适配 */
  .fish-toggle {
    width: 50px;
    height: 50px;
    font-size: 26px;
    left: 6px;
    bottom: 6px;
  }
  
  /* 摸鱼面板适配 */
  .fish-panel {
    font-size: 16px;
  }
  
  .fish-header {
    font-size: 24px;
    padding: 6px 10px;
  }
  
  .fish-close {
    font-size: 26px;
    padding: 4px;
  }
  
  .fish-body {
    font-size: 24px;
    padding: 10px 12px;
  }
}

@media (max-width: 480px) {
  /* 更小屏幕的弹窗适配 */
  #eventModal .modal-content { 
    transform: scale(1.2); 
    max-width: 95vw;
  }
  
  .toast { 
    transform: scale(1.2);
    max-width: 90vw;
  }
  
  .toast.center { 
    transform: translate(-50%, -50%) scale(1.2); 
  }
  
  /* 摸鱼相关元素进一步缩小 */
  .fish-toggle {
    width: 45px;
    height: 45px;
    font-size: 22px;
  }
  
  .fish-header {
    font-size: 20px;
  }
  
  .fish-close {
    font-size: 22px;
  }
  
  .fish-body {
    font-size: 20px;
  }
}

@media (max-width: 360px) {
  /* 超小屏幕的弹窗适配 */
  #eventModal .modal-content { 
    transform: scale(1); 
    max-width: 98vw;
  }
  
  .toast { 
    transform: scale(1);
    max-width: 95vw;
  }
  
  .toast.center { 
    transform: translate(-50%, -50%) scale(1); 
  }
}

/* 结局终端弹窗样式 */
#endingModal .card {
  padding: 1rem;
  overflow: hidden;
  border: 1px solid #c5c5c5;
  border-radius: 12px;
  background-color: #d9d9d92f;
  backdrop-filter: blur(8px);
  min-width: 344px;
  transform: scale(1.8);
  transform-origin: center;
}

#endingModal .wrap {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  position: relative;
  z-index: 10;
  border: 0.5px solid #525252;
  border-radius: 8px;
  overflow: hidden;
}

#endingModal .terminal {
  display: flex;
  flex-direction: column;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
    "Liberation Mono", "Courier New", monospace;
}

#endingModal .head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  overflow: hidden;
  min-height: 40px;
  padding-inline: 12px;
  border-top-left-radius: 8px;
  border-top-right-radius: 8px;
  background-color: #202425;
}

#endingModal .title {
  display: flex;
  align-items: center;
  gap: 8px;
  height: 2.5rem;
  user-select: none;
  font-weight: 600;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  color: #8e8e8e;
}

#endingModal .title > svg {
  height: 18px;
  width: 18px;
  margin-top: 2px;
  color: #006adc;
}

#endingModal .copy_toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0.25rem;
  border: 0.65px solid #c1c2c5;
  margin-left: auto;
  border-radius: 6px;
  background-color: #202425;
  color: #8e8e8e;
  cursor: pointer;
}

#endingModal .copy_toggle > svg {
  width: 20px;
  height: 20px;
}

#endingModal .copy_toggle:active > svg > path,
#endingModal .copy_toggle:focus-within > svg > path {
  animation: clipboard-check 500ms linear forwards;
}

#endingModal .body {
  display: flex;
  flex-direction: column;
  position: relative;
  border-bottom-right-radius: 8px;
  border-bottom-left-radius: 8px;
  overflow-x: auto;
  padding: 1rem;
  line-height: 19px;
  color: white;
  background-color: black;
  white-space: nowrap;
}

#endingModal .pre {
  display: flex;
  flex-direction: row;
  align-items: center;
  text-wrap: nowrap;
  white-space: pre;
  background-color: transparent;
  overflow: hidden;
  box-sizing: border-box;
  font-size: 16px;
}

#endingModal .pre code:nth-child(1) {
  color: #575757;
}

#endingModal .pre code:nth-child(2) {
  color: #e34ba9;
}

#endingModal .cmd {
  height: 19px;
  position: relative;
  display: flex;
  align-items: center;
  flex-direction: row;
}

#endingModal .cmd::before {
  content: attr(data-cmd);
  position: relative;
  display: block;
  white-space: nowrap;
  overflow: hidden;
  background-color: transparent;
  animation: inputs 8s steps(22) infinite;
}

#endingModal .cmd::after {
  content: "";
  position: relative;
  display: block;
  height: 100%;
  overflow: hidden;
  background-color: transparent;
  border-right: 0.15em solid #e34ba9;
  animation: cursor 0.5s step-end infinite alternate, blinking 0.5s infinite;
}

#endingModal .ending-result {
  margin-top: 1rem;
  padding: 0.5rem;
  background-color: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  font-size: 14px;
  line-height: 1.4;
  white-space: pre-wrap;
  word-wrap: break-word;
}

#endingModal .modal-actions {
  margin-top: 1rem;
  display: flex;
  justify-content: center;
}

#endingModal .btn {
  background-color: #006adc;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
  font-weight: 600;
  transition: background-color 0.2s ease;
}

#endingModal .btn:hover {
  background-color: #0056b3;
}

@keyframes blinking {
  20%,
  80% {
    transform: scaleY(1);
  }
  50% {
    transform: scaleY(0);
  }
}

@keyframes cursor {
  50% {
    border-right-color: transparent;
  }
}

@keyframes inputs {
  0%,
  100% {
    width: 0;
  }
  10%,
  90% {
    width: 58px;
  }
  30%,
  70% {
    width: 215px;
    max-width: max-content;
  }
}

@keyframes clipboard-check {
  100% {
    color: #fff;
    d: path(
      "M 9 5 H 7 a 2 2 0 0 0 -2 2 v 12 a 2 2 0 0 0 2 2 h 10 a 2 2 0 0 0 2 -2 V 7 a 2 2 0 0 0 -2 -2 h -2 M 9 5 a 2 2 0 0 0 2 2 h 2 a 2 2 0 0 0 2 -2 M 9 5 a 2 2 0 0 1 2 -2 h 2 a 2 2 0 0 1 2 2 m -6 9 l 2 2 l 4 -4"
    );
  }
}


